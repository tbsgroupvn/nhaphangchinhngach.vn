<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TBS GROUP - Qu·∫£n tr·ªã n·ªôi dung</title>
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      color: white;
    }
    
    .logo {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 1rem;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    
    .subtitle {
      font-size: 1.2rem;
      margin-bottom: 2rem;
      opacity: 0.9;
    }
    
    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(255,255,255,0.3);
      border-top: 4px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .cms-container {
      display: none;
    }
    
    .cms-container.loaded {
      display: block;
    }
    
    .auth-message {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      color: white;
      text-align: center;
      padding: 20px;
    }
    
    .auth-card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 40px;
      max-width: 600px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .auth-button {
      background: rgba(255, 255, 255, 0.2);
      border: 2px solid white;
      color: white;
      padding: 15px 30px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      margin: 10px;
      text-decoration: none;
      display: inline-block;
    }
    
    .auth-button:hover {
      background: white;
      color: #667eea;
      transform: translateY(-2px);
    }
    
    .auth-button.primary {
      background: rgba(34, 197, 94, 0.3);
      border-color: #22c55e;
    }
    
    .auth-button.primary:hover {
      background: #22c55e;
      color: white;
    }
    
    .setup-steps {
      background: rgba(255, 193, 7, 0.1);
      border: 2px solid rgba(255, 193, 7, 0.3);
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      text-align: left;
    }
    
    .setup-steps h4 {
      color: #ffeb3b;
      margin-bottom: 15px;
    }
    
    .setup-steps ol {
      margin-left: 20px;
    }
    
    .setup-steps li {
      margin: 8px 0;
      line-height: 1.4;
    }
    
    /* Custom CSS cho Netlify CMS */
    .nc-app-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
    }
    
    .nc-app-header h1 {
      color: white !important;
    }
    
    .nc-entryEditor-editor {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
    }
    
    /* Identity widget custom styling */
    .netlify-identity-button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="loading-screen" id="loadingScreen">
    <div class="logo">TBS GROUP</div>
    <div class="subtitle">ƒêang t·∫£i h·ªá th·ªëng qu·∫£n tr·ªã...</div>
    <div class="spinner"></div>
  </div>
  
  <div class="auth-message" id="authMessage" style="display: none;">
    <div class="auth-card">
      <div class="logo">üîê TBS GROUP CMS</div>
      <h3 style="margin-bottom: 20px;">Setup Authentication Required</h3>
      <p style="margin-bottom: 20px; opacity: 0.9;">
        CMS s·ª≠ d·ª•ng Auth0 by Okta extension cho authentication.<br/>
        Vui l√≤ng ho√†n th√†nh setup ƒë·ªÉ truy c·∫≠p CMS.
      </p>
      
      <div class="setup-steps">
        <h4>üìã Setup Auth0 Extension:</h4>
        <ol>
          <li>V√†o <strong>Netlify Dashboard</strong> ‚Üí Site c·ªßa b·∫°n</li>
          <li><strong>Integrations</strong> ‚Üí <strong>Browse</strong> ‚Üí T√¨m <strong>"Auth0 by Okta"</strong></li>
          <li>Click <strong>Install</strong> extension</li>
          <li><strong>Site configuration</strong> ‚Üí <strong>Extensions</strong> ‚Üí <strong>Auth0 by Okta</strong></li>
          <li><strong>Add a tenant</strong> ‚Üí Login Auth0 account</li>
          <li><strong>Select project</strong> ‚Üí <strong>Save</strong></li>
          <li><strong>Site Settings</strong> ‚Üí <strong>Identity</strong> ‚Üí <strong>Enable Identity</strong></li>
          <li><strong>Registration</strong> ‚Üí <strong>"Invite only"</strong></li>
          <li><strong>Services</strong> ‚Üí Enable <strong>"Git Gateway"</strong></li>
          <li><strong>Identity tab</strong> ‚Üí <strong>"Invite users"</strong> ‚Üí Nh·∫≠p email</li>
        </ol>
      </div>
      
      <button class="auth-button primary" onclick="openLogin()">
        üöÄ Th·ª≠ ƒëƒÉng nh·∫≠p CMS
      </button>
      <a href="/admin/debug.html" class="auth-button">
        üîß Trang Debug
      </a>
      <a href="https://app.netlify.com" target="_blank" class="auth-button">
        ‚öôÔ∏è Netlify Dashboard
      </a>
      
      <div style="margin-top: 20px; font-size: 14px; opacity: 0.8;">
        <p>C·∫ßn h·ªó tr·ª£? Ki·ªÉm tra <strong>Debug page</strong> ƒë·ªÉ x√°c ƒë·ªãnh v·∫•n ƒë·ªÅ.</p>
      </div>
    </div>
  </div>
  
  <div class="cms-container" id="cmsContainer">
    <!-- Netlify CMS s·∫Ω render ·ªü ƒë√¢y -->
  </div>
  
  <script src="https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js"></script>
  
  <script>
    // C·∫•u h√¨nh ng√¥n ng·ªØ ti·∫øng Vi·ªát to√†n di·ªán
    CMS.registerLocale('vi', {
      app: {
        header: {
          content: 'N·ªôi dung',
          workflow: 'Quy tr√¨nh duy·ªát',
          media: 'Th∆∞ vi·ªán ·∫£nh',
          quickAdd: 'Th√™m nhanh',
          settings: 'C√†i ƒë·∫∑t',
          search: 'T√¨m ki·∫øm'
        }
      },
      collection: {
        sidebar: {
          collections: 'Danh m·ª•c qu·∫£n l√Ω',
          allCollections: 'T·∫•t c·∫£ danh m·ª•c',
          searchAll: 'T√¨m ki·∫øm to√†n b·ªô',
          searchResults: 'K·∫øt qu·∫£ t√¨m ki·∫øm'
        },
        collectionTop: {
          sortBy: 'S·∫Øp x·∫øp theo',
          viewAs: 'Xem d·∫°ng',
          newButton: 'T·∫°o {{collectionLabel}}',
          ascending: 'TƒÉng d·∫ßn',
          descending: 'Gi·∫£m d·∫ßn',
          searchResults: 'K·∫øt qu·∫£ t√¨m "{{searchTerm}}"',
          searchResultsInCollection: 'K·∫øt qu·∫£ t√¨m "{{searchTerm}}" trong {{collection}}'
        },
        entries: {
          loadingEntries: 'ƒêang t·∫£i n·ªôi dung...',
          cachingEntries: 'ƒêang l∆∞u cache...',
          longerLoading: 'Qu√° tr√¨nh n√†y c√≥ th·ªÉ m·∫•t v√†i ph√∫t',
          noEntries: 'Ch∆∞a c√≥ n·ªôi dung n√†o'
        }
      },
      editor: {
        editorControl: {
          field: {
            optional: 'kh√¥ng b·∫Øt bu·ªôc'
          }
        },
        editorControlPane: {
          widget: {
            headingOneTitle: 'Ti√™u ƒë·ªÅ 1',
            headingTwoTitle: 'Ti√™u ƒë·ªÅ 2', 
            headingThreeTitle: 'Ti√™u ƒë·ªÅ 3',
            headingFourTitle: 'Ti√™u ƒë·ªÅ 4',
            headingFiveTitle: 'Ti√™u ƒë·ªÅ 5',
            headingSixTitle: 'Ti√™u ƒë·ªÅ 6',
            bold: 'In ƒë·∫≠m',
            italic: 'In nghi√™ng',
            strikethrough: 'G·∫°ch ngang',
            code: 'M√£ code',
            link: 'Ch√®n li√™n k·∫øt',
            linkPrompt: 'Nh·∫≠p URL c·ªßa li√™n k·∫øt',
            linkTooltip: 'Th√™m li√™n k·∫øt',
            bullist: 'Danh s√°ch d·∫•u ƒë·∫ßu d√≤ng',
            numlist: 'Danh s√°ch ƒë√°nh s·ªë',
            addComponent: 'Th√™m th√†nh ph·∫ßn',
            richText: 'So·∫°n th·∫£o vƒÉn b·∫£n',
            markdown: 'Markdown',
            quote: 'Tr√≠ch d·∫´n',
            image: 'Ch√®n ·∫£nh',
            table: 'T·∫°o b·∫£ng'
          }
        },
        editor: {
          onLeavePage: 'B·∫°n c√≥ ch·∫Øc mu·ªën r·ªùi kh·ªèi trang n√†y?',
          onUpdatingWithUnsavedChanges: 'B·∫°n c√≥ thay ƒë·ªïi ch∆∞a l∆∞u, vui l√≤ng l∆∞u tr∆∞·ªõc khi c·∫≠p nh·∫≠t tr·∫°ng th√°i.',
          onPublishingNotReady: 'Vui l√≤ng gi·∫£i quy·∫øt c√°c v·∫•n ƒë·ªÅ tr∆∞·ªõc khi xu·∫•t b·∫£n.',
          onPublishingWithUnsavedChanges: 'B·∫°n c√≥ thay ƒë·ªïi ch∆∞a l∆∞u, vui l√≤ng l∆∞u tr∆∞·ªõc khi xu·∫•t b·∫£n.',
          onPublishing: 'B·∫°n c√≥ ch·∫Øc mu·ªën xu·∫•t b·∫£n?',
          onUnpublishing: 'B·∫°n c√≥ ch·∫Øc mu·ªën h·ªßy xu·∫•t b·∫£n?',
          onDeleteWithUnsavedChanges: 'B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a m·ª•c n√†y c√πng v·ªõi c√°c thay ƒë·ªïi ch∆∞a l∆∞u?',
          onDeletePublishedEntry: 'B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a m·ª•c ƒë√£ xu·∫•t b·∫£n n√†y?',
          onDeleteUnpublishedChangesWithUnsavedChanges: 'ƒêi·ªÅu n√†y s·∫Ω x√≥a t·∫•t c·∫£ thay ƒë·ªïi ch∆∞a xu·∫•t b·∫£n c·ªßa m·ª•c n√†y, c≈©ng nh∆∞ c√°c thay ƒë·ªïi ch∆∞a l∆∞u hi·ªán t·∫°i. B·∫°n v·∫´n mu·ªën x√≥a?',
          onDeleteUnpublishedChanges: 'T·∫•t c·∫£ thay ƒë·ªïi ch∆∞a xu·∫•t b·∫£n c·ªßa m·ª•c n√†y s·∫Ω b·ªã x√≥a. B·∫°n v·∫´n mu·ªën x√≥a?',
          loadingEntry: 'ƒêang t·∫£i...',
          confirmLoadBackup: 'Ph√°t hi·ªán b·∫£n backup cho m·ª•c n√†y, b·∫°n c√≥ mu·ªën s·ª≠ d·ª•ng kh√¥ng?'
        },
        editorInterface: {
          toggleI18n: 'Chuy·ªÉn ƒë·ªïi ng√¥n ng·ªØ',
          togglePreview: 'Xem tr∆∞·ªõc',
          toggleScrollSync: 'ƒê·ªìng b·ªô cu·ªôn trang'
        },
        editorToolbar: {
          publishing: 'ƒêang xu·∫•t b·∫£n...',
          publish: 'Xu·∫•t b·∫£n',
          published: 'ƒê√£ xu·∫•t b·∫£n',
          unpublish: 'H·ªßy xu·∫•t b·∫£n',
          duplicate: 'Nh√¢n b·∫£n',
          unpublishing: 'ƒêang h·ªßy xu·∫•t b·∫£n...',
          publishAndCreateNew: 'Xu·∫•t b·∫£n v√† t·∫°o m·ªõi',
          deleteUnpublishedChanges: 'X√≥a thay ƒë·ªïi ch∆∞a xu·∫•t b·∫£n',
          deleteUnpublishedEntry: 'X√≥a m·ª•c ch∆∞a xu·∫•t b·∫£n',
          deletePublishedEntry: 'X√≥a m·ª•c ƒë√£ xu·∫•t b·∫£n',
          deleteEntry: 'X√≥a',
          saving: 'ƒêang l∆∞u...',
          save: 'L∆∞u',
          deleting: 'ƒêang x√≥a...',
          updating: 'ƒêang c·∫≠p nh·∫≠t...',
          status: 'Tr·∫°ng th√°i: {{status}}',
          backCollection: '‚Üê Quay l·∫°i {{collectionLabel}}',
          unsavedChanges: 'Thay ƒë·ªïi ch∆∞a l∆∞u',
          changesSaved: 'ƒê√£ l∆∞u thay ƒë·ªïi',
          draft: 'B·∫£n nh√°p',
          inReview: 'ƒêang review',
          ready: 'S·∫µn s√†ng',
          publishNow: 'Xu·∫•t b·∫£n ngay',
          deployPreviewPending: 'ƒêang chu·∫©n b·ªã xem tr∆∞·ªõc',
          deployPreviewReady: 'Xem tr∆∞·ªõc s·∫µn s√†ng',
          deployButtonLabel: 'Xem tr·ª±c ti·∫øp'
        },
        editorWidgets: {
          markdown: {
            bold: 'In ƒë·∫≠m',
            italic: 'In nghi√™ng',
            code: 'Code',
            link: 'Li√™n k·∫øt',
            linkPrompt: 'Nh·∫≠p URL',
            headings: 'Ti√™u ƒë·ªÅ',
            quote: 'Tr√≠ch d·∫´n',
            bullist: 'Danh s√°ch',
            numlist: 'Danh s√°ch s·ªë',
            addComponent: 'Th√™m th√†nh ph·∫ßn'
          },
          image: {
            choose: 'Ch·ªçn ·∫£nh',
            chooseUrl: 'Ch√®n t·ª´ URL',
            replaceUrl: 'Thay th·∫ø b·∫±ng URL',
            promptUrl: 'Nh·∫≠p URL c·ªßa ·∫£nh',
            chooseDifferent: 'Ch·ªçn ·∫£nh kh√°c',
            remove: 'X√≥a ·∫£nh'
          },
          file: {
            choose: 'Ch·ªçn file',
            chooseUrl: 'Ch√®n t·ª´ URL',
            replaceUrl: 'Thay th·∫ø b·∫±ng URL',
            promptUrl: 'Nh·∫≠p URL c·ªßa file',
            chooseDifferent: 'Ch·ªçn file kh√°c',
            remove: 'X√≥a file'
          },
          unknownControl: {
            noControl: "Kh√¥ng c√≥ control cho widget '{{widget}}'."
          },
          unknownPreview: {
            noPreview: "Kh√¥ng c√≥ preview cho widget '{{widget}}'."
          },
          headingOptions: {
            headingOne: 'Ti√™u ƒë·ªÅ 1',
            headingTwo: 'Ti√™u ƒë·ªÅ 2',
            headingThree: 'Ti√™u ƒë·ªÅ 3',
            headingFour: 'Ti√™u ƒë·ªÅ 4',
            headingFive: 'Ti√™u ƒë·ªÅ 5',
            headingSix: 'Ti√™u ƒë·ªÅ 6'
          },
          datetime: {
            now: 'B√¢y gi·ªù',
            invalidDateTitle: 'Ng√†y kh√¥ng h·ª£p l·ªá',
            invalidDateBody: 'Ng√†y b·∫°n nh·∫≠p kh√¥ng h·ª£p l·ªá.'
          },
          list: {
            add: '+ Th√™m {{item}}',
            addType: '+ Th√™m {{item}}',
            noValue: 'Ch∆∞a c√≥ gi√° tr·ªã n√†o'
          },
          keyvalue: {
            uniqueKeys: 'Keys ph·∫£i l√† duy nh·∫•t'
          },
          code: {
            language: 'Ng√¥n ng·ªØ',
            selectLanguage: 'Ch·ªçn ng√¥n ng·ªØ'
          }
        }
      },
      mediaLibrary: {
        mediaLibraryCard: {
          draft: 'B·∫£n nh√°p',
          copy: 'Sao ch√©p',
          copyUrl: 'Sao ch√©p URL',
          copyPath: 'Sao ch√©p ƒë∆∞·ªùng d·∫´n',
          copyName: 'Sao ch√©p t√™n',
          copied: 'ƒê√£ sao ch√©p'
        },
        mediaLibrary: {
          onDelete: 'B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a media ƒë√£ ch·ªçn?',
          fileTooLarge: 'File qu√° l·ªõn.\nC·∫•u h√¨nh kh√¥ng cho ph√©p file l·ªõn h∆°n {{size}} kB.',
          alreadyExists: 'File ƒë√£ t·ªìn t·∫°i. B·∫°n c√≥ mu·ªën thay th·∫ø kh√¥ng?'
        },
        mediaLibraryModal: {
          loading: 'ƒêang t·∫£i...',
          noResults: 'Kh√¥ng c√≥ k·∫øt qu·∫£.',
          noAssetsFound: 'Kh√¥ng t√¨m th·∫•y media n√†o.',
          noImagesFound: 'Kh√¥ng t√¨m th·∫•y ·∫£nh n√†o.',
          images: '·∫¢nh',
          mediaAssets: 'Media',
          search: 'T√¨m ki·∫øm...',
          uploading: 'ƒêang t·∫£i l√™n...',
          upload: 'T·∫£i l√™n',
          download: 'T·∫£i xu·ªëng',
          deleting: 'ƒêang x√≥a...',
          deleteSelected: 'X√≥a ƒë√£ ch·ªçn',
          chooseSelected: 'Ch·ªçn ƒë√£ ch·ªçn'
        }
      },
      ui: {
        default: {
          goBackToSite: 'Quay l·∫°i website',
          errorHeader: 'L·ªói khi t·∫£i CMS',
          errorDetails: 'ƒê√£ x·∫£y ra l·ªói - vui l√≤ng ki·ªÉm tra console ƒë·ªÉ bi·∫øt chi ti·∫øt.',
          errorBoundaryHeader: 'L·ªói CMS',
          errorBoundaryDetails: 'ƒê√£ x·∫£y ra l·ªói - vui l√≤ng '
        },
        errorBoundary: {
          title: 'L·ªói',
          details: 'ƒê√£ x·∫£y ra l·ªói - vui l√≤ng ',
          reportIt: 'b√°o c√°o tr√™n GitHub.',
          detailsHeading: 'Chi ti·∫øt',
          privacyWarning: 'M·ªü issue s·∫Ω t·ª± ƒë·ªông ƒëi·ªÅn th√¥ng tin l·ªói v√† debug.\nVui l√≤ng x√°c minh th√¥ng tin l√† ch√≠nh x√°c v√† x√≥a d·ªØ li·ªáu nh·∫°y c·∫£m n·∫øu c√≥.',
          recoveredEntry: {
            heading: 'T√†i li·ªáu ƒë√£ kh√¥i ph·ª•c',
            warning: 'Vui l√≤ng copy/paste n·ªôi dung n√†y ·ªü n∆°i kh√°c tr∆∞·ªõc khi ƒëi·ªÅu h∆∞·ªõng ƒëi!',
            copyButtonLabel: 'Sao ch√©p v√†o clipboard'
          }
        },
        settingsDropdown: {
          logOut: 'ƒêƒÉng xu·∫•t'
        },
        toast: {
          onFailToLoadEntries: 'Kh√¥ng th·ªÉ t·∫£i m·ª•c: {{details}}',
          onFailToLoadDeployPreview: 'Kh√¥ng th·ªÉ t·∫£i preview: {{details}}',
          onFailToPersist: 'Kh√¥ng th·ªÉ l∆∞u m·ª•c: {{details}}',
          onFailToDelete: 'Kh√¥ng th·ªÉ x√≥a m·ª•c: {{details}}',
          onFailToUpdateStatus: 'Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t tr·∫°ng th√°i: {{details}}',
          missingRequiredField: 'B·∫°n ƒë√£ b·ªè qua tr∆∞·ªùng b·∫Øt bu·ªôc. Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß tr∆∞·ªõc khi l∆∞u.',
          entrySaved: 'ƒê√£ l∆∞u m·ª•c',
          entryPublished: 'ƒê√£ xu·∫•t b·∫£n m·ª•c',
          entryUnpublished: 'ƒê√£ h·ªßy xu·∫•t b·∫£n m·ª•c',
          onFailToPublishEntry: 'Kh√¥ng th·ªÉ xu·∫•t b·∫£n: {{details}}',
          onFailToUnpublishEntry: 'Kh√¥ng th·ªÉ h·ªßy xu·∫•t b·∫£n: {{details}}',
          entryUpdated: 'ƒê√£ c·∫≠p nh·∫≠t tr·∫°ng th√°i m·ª•c',
          onDeleteUnpublishedChanges: 'ƒê√£ x√≥a thay ƒë·ªïi ch∆∞a xu·∫•t b·∫£n',
          onFailToAuth: 'L·ªói x√°c th·ª±c: {{details}}',
          onLoggedOut: 'B·∫°n ƒë√£ ƒëƒÉng xu·∫•t, vui l√≤ng backup d·ªØ li·ªáu v√† ƒëƒÉng nh·∫≠p l·∫°i',
          onBackendDown: 'Backend ƒëang g·∫∑p s·ª± c·ªë. Xem {{details}} ƒë·ªÉ bi·∫øt th√™m th√¥ng tin'
        }
      },
      workflow: {
        workflow: {
          loading: 'ƒêang t·∫£i m·ª•c Editorial Workflow',
          workflowHeading: 'Editorial Workflow',
          newPost: 'B√†i vi·∫øt m·ªõi',
          description: 'S·ªë l∆∞·ª£ng m·ª•c ƒëang ch·ªù review.',
          dateFormat: 'MMMM D',
          dateFormatCardHeader: 'MMM D'
        },
        workflowCard: {
          lastChange: 'Thay ƒë·ªïi cu·ªëi {{date}} b·ªüi {{author}}',
          lastChangeNoAuthor: 'Thay ƒë·ªïi cu·ªëi {{date}}',
          lastChangeNoDate: 'Thay ƒë·ªïi cu·ªëi b·ªüi {{author}}',
          deleteChanges: 'X√≥a thay ƒë·ªïi',
          deleteNewEntry: 'X√≥a m·ª•c m·ªõi',
          publishChanges: 'Xu·∫•t b·∫£n thay ƒë·ªïi',
          publishNewEntry: 'Xu·∫•t b·∫£n m·ª•c m·ªõi'
        },
        workflowList: {
          onDeleteEntry: 'B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a m·ª•c n√†y?',
          onPublishingNotReadyEntry: 'Ch·ªâ c√≥ th·ªÉ xu·∫•t b·∫£n m·ª•c c√≥ tr·∫°ng th√°i "S·∫µn s√†ng". Vui l√≤ng k√©o th·∫ª v√†o c·ªôt "S·∫µn s√†ng" ƒë·ªÉ enable xu·∫•t b·∫£n.',
          onPublishEntry: 'B·∫°n c√≥ ch·∫Øc mu·ªën xu·∫•t b·∫£n m·ª•c n√†y?',
          draftHeader: 'B·∫£n nh√°p',
          inReviewHeader: 'ƒêang Review',
          readyHeader: 'S·∫µn s√†ng',
          currentEntries: '{{smart_count}} m·ª•c |||| {{smart_count}} m·ª•c'
        }
      }
    });
    
    function openLogin() {
      if (window.netlifyIdentity) {
        try {
          window.netlifyIdentity.open();
          console.log('‚úÖ Opened identity widget');
        } catch (error) {
          console.error('‚ùå Error opening identity:', error);
          alert('L·ªói m·ªü identity widget. Vui l√≤ng ki·ªÉm tra setup Auth0 extension.');
        }
      } else {
        console.error('‚ùå Netlify Identity not available');
        alert('Netlify Identity ch∆∞a s·∫µn s√†ng. Vui l√≤ng ho√†n th√†nh setup Auth0 extension.');
      }
    }
    
    function hideLoading() {
      document.getElementById('loadingScreen').style.display = 'none';
    }
    
    function showAuthMessage() {
      hideLoading();
      document.getElementById('authMessage').style.display = 'flex';
    }
    
    function hideAuthMessage() {
      document.getElementById('authMessage').style.display = 'none';
      document.getElementById('cmsContainer').classList.add('loaded');
    }
    
    function initializeCMS() {
      try {
        // Kh·ªüi t·∫°o CMS v·ªõi c·∫•u h√¨nh Auth0 extension
        CMS.init({
          config: {
            load_config_file: true,
            // Local backend ch·ªâ enable khi localhost
            local_backend: window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1',
            // Auth0 extension s·∫Ω t·ª± ƒë·ªông inject environment variables
          }
        });
        
        console.log('‚úÖ CMS initialized successfully');
        hideAuthMessage();
      } catch (error) {
        console.error('‚ùå Error initializing CMS:', error);
        showAuthMessage();
      }
    }
    
    // Enhanced error handling function
    function handleAuthError(error, context) {
      console.error(`‚ùå Auth error in ${context}:`, error);
      
      let errorMessage = 'Authentication error occurred. ';
      
      if (error.message && error.message.includes('auth0')) {
        errorMessage += 'Please check Auth0 extension configuration.';
      } else if (error.message && error.message.includes('identity')) {
        errorMessage += 'Please enable Netlify Identity service.';
      } else {
        errorMessage += 'Please check debug page for details.';
      }
      
      // Show user-friendly error
      const authCard = document.querySelector('.auth-card h3');
      if (authCard) {
        authCard.textContent = '‚ùå Authentication Error';
        authCard.style.color = '#fecaca';
      }
    }
    
    // Initialize authentication flow
    function initializeAuth() {
      if (!window.netlifyIdentity) {
        console.error('‚ùå Netlify Identity widget not loaded');
        hideLoading();
        showAuthMessage();
        return;
      }
      
      console.log('üîß Netlify Identity widget loaded');
      
      // Check initial auth state
      try {
        const user = window.netlifyIdentity.currentUser();
        
        if (user) {
          console.log('‚úÖ User already authenticated:', user.email);
          initializeCMS();
        } else {
          console.log('‚ö†Ô∏è No authenticated user found');
          hideLoading();
          showAuthMessage();
        }
      } catch (error) {
        handleAuthError(error, 'initial check');
        hideLoading();
        showAuthMessage();
      }
    }
    
    // Netlify Identity event handlers with Auth0 extension support
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("init", user => {
        console.log('üîß Identity init event:', user ? user.email : 'no user');
        
        hideLoading();
        
        if (user) {
          console.log('‚úÖ User authenticated on init:', user.email);
          initializeCMS();
        } else {
          console.log('‚ùå User not authenticated on init');
          showAuthMessage();
        }
      });
      
      window.netlifyIdentity.on("login", (user) => {
        console.log('‚úÖ Login successful:', user.email);
        try {
          initializeCMS();
        } catch (error) {
          handleAuthError(error, 'login');
        }
      });
      
      window.netlifyIdentity.on("logout", () => {
        console.log('‚ÑπÔ∏è User logged out');
        showAuthMessage();
      });
      
      window.netlifyIdentity.on("error", (err) => {
        handleAuthError(err, 'identity widget');
        hideLoading();
        showAuthMessage();
      });
      
    } else {
      // Fallback n·∫øu Identity widget kh√¥ng load
      console.error('‚ùå Netlify Identity widget not available');
      setTimeout(() => {
        if (!window.netlifyIdentity) {
          console.error('‚ùå Netlify Identity failed to load after timeout');
          hideLoading();
          showAuthMessage();
        } else {
          initializeAuth();
        }
      }, 5000);
    }
    
    // Debug information
    console.log('üéØ TBS GROUP CMS with Auth0 Extension Support');
    console.log('üåê Environment:', window.location.hostname);
    console.log('üîß Local backend:', window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1');
    
    // Check if Auth0 extension variables are available
    setTimeout(() => {
      console.log('üîç Checking Auth0 extension environment...');
      // Auth0 extension variables should be available via build process
      console.log('‚ÑπÔ∏è Auth0 variables are managed by Netlify extension');
    }, 1000);
  </script>
</body>
</html> 